<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, minimum-scale=1, user-scalable=no"
  />
  <title>HRT Hormones at a Glance — MenoHello</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    :root{
      --pink-bg:#ffe9e5;   /* brand */
      --pink-accent:#ffa798; /* brand */
      --white:#ffffff;     /* brand */
      --plum:#8e599c;      /* brand */
      --ink:#231f20;
    }
    html,body{
      margin:0;
      font-family:Poppins, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--ink);
      background:var(--pink-bg);
    }
    .wrap{
      max-width:1100px;
      margin:40px auto;
      padding:24px;
    }
    .card{
      background:var(--white);
      border-radius:20px;
      box-shadow:0 6px 18px rgb(0 0 0 / 8%);
      overflow:hidden;
      border:1px solid rgb(0 0 0 / 4%);
    }
    .header{
      padding:24px clamp(18px,3vw,28px);
      background:linear-gradient(180deg, var(--pink-bg), #fff);
      border-bottom:1px solid rgb(0 0 0 / 6%);
    }
    .title{
      margin:0 0 6px;
      font-size:clamp(22px, 3.2vw, 34px);
      line-height:1.15;
      color:var(--plum);
      font-weight:700;
      letter-spacing:0.2px;
    }
    .subtitle{
      margin:0;
      font-size:clamp(13px,1.8vw,15px);
      color:#5b4a60;
    }
    .legend{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      padding:14px 18px;
      background: #fff;
      border-top: 1px solid rgb(0 0 0 / 6%);
      border-bottom: 1px solid rgb(0 0 0 / 6%);
    }
    .pill{
      border-radius:999px;
      padding:6px 10px;
      font-size:12px;
      border:1px solid rgb(0 0 0 / 10%);
      background:var(--pink-bg);
      color:#5b4a60;
    }
    .table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
    }
    .th, .td{
      padding:14px 16px;
      text-align:left;
      vertical-align:top;
      border-bottom:1px solid rgb(0 0 0 / 6%);
    }
    .th{
      background:var(--plum);
      color:#fff;
      font-weight:600;
      position:sticky;
      top:0;
      z-index:2;
    }
    .row:nth-child(even) .td{ background:#faf7fb; }
    .badge{
      display:inline-block;
      padding:4px 10px;
      border-radius:999px;
      font-size:12px;
      line-height:1.2;
      border:1px solid rgb(0 0 0 / 10%);
      background:var(--pink-bg);
      color:#5b4a60;
      white-space:nowrap;
    }
    .yes{ background:#e5f8ef; color:#16543b; border-color:#bfe9d6; }
    .no{ background:#fdeeee; color:#7d2424; border-color:#f8c7c7; }
    .chip{
      display:inline-block;
      margin:4px 6px 0 0;
      padding:6px 10px;
      border-radius:14px;
      border:1px dashed rgb(0 0 0 / 16%);
      font-size:12px;
      background:#fff;
    }
    .footer{
      display:flex; gap:10px; justify-content:space-between; align-items:center;
      padding:16px 18px;
      background:#fff; color:#5b4a60; font-size:12px;
    }
    .btn{
      appearance:none; border:none; cursor:pointer;
      padding:10px 14px; border-radius:12px; font-weight:600;
      background:var(--pink-accent); color:#3a1c2a;
      box-shadow:0 4px 10px rgb(0 0 0 / 8%);
    }
    .btn:active{ transform:translateY(1px); }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }

    /* Mobile cards */
    @media (max-width:820px){
      .table, .th, .td, .tr, thead{ display:block; }
      thead{ display:none; }
      .row{
        border-bottom:1px solid rgb(0 0 0 / 8%);
        padding:14px 16px;
      }
      .td{
        border:0; padding:2px 0;
      }
      .row + .row{ background:#fff; }
      .row h3{
        margin:0 0 8px; color:var(--plum); font-size:18px;
      }
      .stack{ margin-top:8px; }
      .label{ font-size:12px; color:#6b6b6b; margin-top:8px; }
    }

    /* Print-friendly */
    @media print{
      .wrap{ margin:0; padding:0; }
      .header, .legend, .footer, .btn{ display:none !important; }
      .card{ box-shadow:none; border:none; }
      .th{ position:static; }
      .row:nth-child(even) .td{ background:#fff; }
    }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card" aria-labelledby="title">
      <header class="header">
        <h1 id="title" class="title">HRT Hormones at a Glance</h1>
        <p class="subtitle">Live-updating from your Google Sheet (&ldquo;Infographic&rdquo; tab). Shareable, printable, brand-styled.</p>
      </header>

      <div class="legend" aria-hidden="true">
        <span class="pill">Brand: #ffe9e5 • #ffa798 • #ffffff • #8e599c</span>
        <span class="pill">Transdermal = bypasses liver</span>
        <span class="pill">Oral = first-pass liver metabolism</span>
      </div>

      <!-- Desktop table -->
      <div id="tableWrap">
        <table class="table" role="table" aria-label="HRT Hormones Reference">
          <thead>
            <tr class="tr">
              <th class="th">Hormone</th>
              <th class="th">Bioidentical?</th>
              <th class="th">Primary Role in HRT</th>
              <th class="th">Common Forms</th>
              <th class="th">Liver Processing?</th>
              <th class="th">Key Notes</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>

      <!-- Mobile cards -->
      <div id="cards" class="sr-only" aria-live="polite"></div>

      <footer class="footer">
        <span id="status">Loading data…</span>
        <div>
          <button class="btn" onclick="window.print()">Print / Save PDF</button>
        </div>
      </footer>
    </section>
  </main>

  <script>
    /**
     * CONFIG
     */
    const SHEET_ID   = "1BCVC4IIhqWuNpGW1zyg112gNqevA5zEue1mMMmUkJQo";
    const SHEET_NAME = "Infographic"; // worksheet/tab name
    const GVIZ_URL   = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${encodeURIComponent(SHEET_NAME)}&tqx=out:json`;

    /**
     * Utility: Parse Google gviz JSON
     */
    function parseGViz(txt){
      // gviz wraps JSON in "/*O_o*/\ngoogle.visualization.Query.setResponse(...);"
      const start = txt.indexOf("{");
      const end   = txt.lastIndexOf("}");
      const json  = txt.substring(start, end+1);
      return JSON.parse(json);
    }

    /**
     * Utility: convert gviz table rows to array of objects using header row
     */
    function tableToObjects(gviz){
      const cols = gviz.table.cols.map(c => (c.label || c.id || "").trim());
      const rows = gviz.table.rows || [];
      return rows.map(r => {
        const obj = {};
        r.c.forEach((cell, i) => {
          obj[cols[i] || `col_${i}`] = cell ? (cell.f ?? cell.v ?? "") : "";
        });
        return obj;
      });
    }

    /**
     * UI helpers
     */
    const $tbody = document.getElementById("tbody");
    const $cards = document.getElementById("cards");
    const $status = document.getElementById("status");

    function badgeYesNo(val){
      if(typeof val !== "string") val = String(val ?? "");
      const v = val.trim().toLowerCase();
      const yeses = ["yes","y","true","✓","✔","bioidentical","usually yes"];
      const nos   = ["no","n","false","✗","×","x","not bioidentical","usually no"];
      if(yeses.includes(v)) return `<span class="badge yes">${val}</span>`;
      if(nos.includes(v))   return `<span class="badge no">${val}</span>`;
      return `<span class="badge">${val}</span>`;
    }

    function chips(list){
      if(!list) return "";
      // Accept comma- or semicolon-separated lists
      const parts = String(list).split(/[,;]\s*/).filter(Boolean);
      return parts.map(p => `<span class="chip">${p}</span>`).join("");
    }

    function createRow(item){
      // Expected column names in the sheet
      const h  = item["Hormone"] ?? item["Hormone Name"] ?? "";
      const bi = item["Bioidentical?"] ?? item["Bioidentical"] ?? "";
      const pr = item["Primary Role in HRT"] ?? item["Primary Role"] ?? "";
      const cf = item["Common Forms"] ?? item["Forms"] ?? "";
      const lp = item["Liver Processing?"] ?? item["Liver?"] ?? "";
      const kn = item["Key Notes"] ?? item["Notes"] ?? "";

      const tr = document.createElement("tr");
      tr.className = "tr row";
      tr.innerHTML = `
        <td class="td"><strong style="color:var(--plum)">${h}</strong></td>
        <td class="td">${badgeYesNo(bi)}</td>
        <td class="td">${pr}</td>
        <td class="td">${chips(cf)}</td>
        <td class="td">${badgeYesNo(lp)}</td>
        <td class="td">${kn}</td>
      `;
      return tr;
    }

    function createCard(item){
      const h  = item["Hormone"] ?? item["Hormone Name"] ?? "";
      const bi = item["Bioidentical?"] ?? item["Bioidentical"] ?? "";
      const pr = item["Primary Role in HRT"] ?? item["Primary Role"] ?? "";
      const cf = item["Common Forms"] ?? item["Forms"] ?? "";
      const lp = item["Liver Processing?"] ?? item["Liver?"] ?? "";
      const kn = item["Key Notes"] ?? item["Notes"] ?? "";

      const wrap = document.createElement("div");
      wrap.className = "row";
      wrap.innerHTML = `
        <h3>${h}</h3>
        <div class="stack">
          <div class="label">Bioidentical?</div>
          ${badgeYesNo(bi)}
        </div>
        <div class="stack">
          <div class="label">Primary Role</div>
          <div>${pr}</div>
        </div>
        <div class="stack">
          <div class="label">Common Forms</div>
          <div>${chips(cf)}</div>
        </div>
        <div class="stack">
          <div class="label">Liver Processing?</div>
          ${badgeYesNo(lp)}
        </div>
        <div class="stack">
          <div class="label">Key Notes</div>
          <div>${kn}</div>
        </div>
      `;
      return wrap;
    }

    /**
     * Responsive toggle (table for desktop, cards for mobile)
     */
    function setMobile(isMobile){
      if(isMobile){
        document.getElementById("tableWrap").classList.add("sr-only");
        $cards.classList.remove("sr-only");
      }else{
        document.getElementById("tableWrap").classList.remove("sr-only");
        $cards.classList.add("sr-only");
      }
    }
    const mq = window.matchMedia("(max-width:820px)");
    setMobile(mq.matches);
    mq.addEventListener("change", e => setMobile(e.matches));

    /**
     * Fetch & render
     */
    async function load(){
      try{
        $status.textContent = "Loading data…";
        const res = await fetch(GVIZ_URL, { cache: "no-store" });
        if(!res.ok) throw new Error(`HTTP ${res.status}`);
        const txt = await res.text();
        const data = parseGViz(txt);
        const rows = tableToObjects(data);

        // Clear old
        $tbody.innerHTML = "";
        $cards.innerHTML = "";

        // Render
        rows.forEach(item => {
          $tbody.appendChild(createRow(item));
          $cards.appendChild(createCard(item));
        });

        const updated = data.reqId != null
          ? new Date().toLocaleString()
          : "";
        $status.textContent = `Loaded ${rows.length} row(s).`;
      }catch(err){
        console.error(err);
        $status.textContent = "Could not load sheet. Check sharing & tab name.";
      }
    }
    load();
  </script>
</body>
</html>
